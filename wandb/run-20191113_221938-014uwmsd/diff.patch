diff --git a/.vscode/settings.json b/.vscode/settings.json
index 016601c..8805d73 100644
--- a/.vscode/settings.json
+++ b/.vscode/settings.json
@@ -1,5 +1,5 @@
 {
-    "python.pythonPath": "C:\\Users\\user\\AppData\\Local\\Programs\\Python\\Python38-32\\python.exe",
+    "python.pythonPath": "/usr/bin/python3",
     "python.linting.pylintEnabled": true,
     "python.linting.enabled": true
 }
\ No newline at end of file
diff --git a/__pycache__/data_loader.cpython-36.pyc b/__pycache__/data_loader.cpython-36.pyc
index d0ac81e..5d00db5 100644
Binary files a/__pycache__/data_loader.cpython-36.pyc and b/__pycache__/data_loader.cpython-36.pyc differ
diff --git a/data_loader.py b/data_loader.py
index a897df2..f17d0a2 100644
--- a/data_loader.py
+++ b/data_loader.py
@@ -2,28 +2,32 @@ import torch
 import torch.utils.data
 from torchvision import datasets, transforms
 import PIL
+import numpy as np
 import pandas as pd
 
+class MNISTTrainDataset(torch.utils.data.Dataset):
+    def __init__(self, path):
+        self.transform = transforms.Compose(
+                            [transforms.ToPILImage(), transforms.RandomAffine(20,(0.11,0.11)),
+                             transforms.ToTensor(), transforms.Normalize(mean=(0.1307,), std=(0.3081,))])
+        df = pd.read_csv(path)
+        self.X = df.iloc[:,1:].values.reshape((-1,28,28)).astype(np.uint8)[:,:,:,None]
+        self.y = torch.from_numpy(df.iloc[:,0].values)
 
+    def __len__(self):
+        return len(self.X)
 
-train_loader = torch.utils.data.DataLoader(
-    datasets.MNIST('../data', train=True, download=True,
-                    transform=transforms.Compose([
-                        transforms.RandomRotation(45, resample=PIL.Image.BILINEAR), # аугментация: поворот до 45°
-                        transforms.ToTensor(),
-                        transforms.Normalize((0.1307,), (0.3081,))
-                    ])),
-    batch_size=64, shuffle=True, num_workers=1, pin_memory=True)
+    def __getitem__(self, idx):
+        return self.transform(self.X[idx]), self.y[idx]
 
-test_loader = torch.utils.data.DataLoader(
-    datasets.MNIST('../data', train=False, transform=transforms.Compose([
-                        transforms.ToTensor(),
-                        transforms.Normalize((0.1307,), (0.3081,))
-                    ])),
-    batch_size=1000, shuffle=True, num_workers=1, pin_memory=True)
+class MNISTTestDataset(torch.utils.data.Dataset):
+    def __init__(self, path):
+        self.transform = transforms.Compose([transforms.ToPILImage(), transforms.ToTensor(), transforms.Normalize(mean=(0.1307,), std=(0.3081,))])
+        df = pd.read_csv(path)
+        self.X = df.values.reshape((-1,28,28)).astype(np.uint8)[:,:,:,None]
 
-test_df = pd.read_csv("test.csv")
-test_images = (test_df.iloc[:,:].values).astype('float32')
-test_images = test_images.reshape(test_images.shape[0], 28, 28)
-test_images_tensor = torch.tensor(test_images)/255.0
-kaggle_loader=torch.utils.data.DataLoader(test_images_tensor, batch_size=1, num_workers=1, shuffle=False)
+    def __len__(self):
+        return len(self.X)
+    
+    def __getitem__(self, idx):
+            return self.transform(self.X[idx])
diff --git a/train.py b/train.py
index 0321cc6..a37997d 100644
--- a/train.py
+++ b/train.py
@@ -1,12 +1,13 @@
 import torch
 import torch.optim as optim
 from lenet import LeNetEnsemble
-from data_loader import train_loader, test_loader, kaggle_loader
+from data_loader import MNISTTrainDataset, MNISTTestDataset
 import torch.nn.functional as F
 import os
 from torch.autograd import Variable
 import numpy as np
 import pandas as pd
+import torch.utils.data
 
 import wandb
 wandb.init(project="digit-recognizer")
@@ -78,7 +79,8 @@ if __name__ == "__main__":
     epochs = args.epochs
     momentum = args.momentum
     device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
-
+    train_loader = torch.utils.data.DataLoader(dataset=MNISTTrainDataset("train.csv"), batch_size=1000, shuffle=True)
+    test_loader = torch.utils.data.DataLoader(dataset=MNISTTestDataset("test.csv"),batch_size=1000, shuffle=False)
     model = LeNetEnsemble(15, device)
     wandb.watch(model, log="all")
     optimizer = optim.SGD(model.parameters(), lr=lr, momentum=momentum)
diff --git a/wandb/debug.log b/wandb/debug.log
index 776910b..09e4168 100644
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1,58 +1,18 @@
-2019-11-14 00:33:41,479 DEBUG   MainThread:6586 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
-2019-11-14 00:33:41,484 DEBUG   MainThread:6586 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=<valid stream>)
-2019-11-14 00:33:41,488 DEBUG   MainThread:6586 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
-2019-11-14 00:33:41,490 DEBUG   MainThread:6586 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
-2019-11-14 00:33:41,495 DEBUG   MainThread:6586 [run_manager.py:__init__():535] Initialized sync for digit-recognizer/opwf6x0m
-2019-11-14 00:33:41,497 INFO    MainThread:6586 [run_manager.py:wrap_existing_process():1131] wrapping existing process 6573
-2019-11-14 00:33:41,498 WARNING MainThread:6586 [io_wrap.py:register():104] SIGWINCH handler was not None: <Handlers.SIG_DFL: 0>
-2019-11-14 00:33:41,500 DEBUG   MainThread:6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
-2019-11-14 00:33:41,642 DEBUG   MainThread:6586 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
-2019-11-14 00:33:41,687 INFO    MainThread:6586 [run_manager.py:init_run():916] system metrics and metadata threads started
-2019-11-14 00:33:41,687 INFO    MainThread:6586 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
-2019-11-14 00:33:41,695 DEBUG   Thread-14 :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-14 00:33:42,001 DEBUG   Thread-14 :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 574
-2019-11-14 00:33:42,005 INFO    Thread-14 :6586 [run_manager.py:_upsert_run():1035] saving patches
-2019-11-14 00:33:42,005 DEBUG   Thread-14 :6586 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
-2019-11-14 00:33:42,009 DEBUG   Thread-14 :6586 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
-2019-11-14 00:33:42,013 DEBUG   Thread-14 :6586 [cmd.py:execute():724] Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
-2019-11-14 00:33:42,018 DEBUG   Thread-14 :6586 [cmd.py:execute():724] Popen(['git', 'version'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
-2019-11-14 00:33:42,028 DEBUG   Thread-14 :6586 [cmd.py:execute():724] Popen(['git', 'merge-base', 'HEAD', '957466bf2d3a1406cef35e6c640bd0769d31d57c'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
-2019-11-14 00:33:42,031 INFO    Thread-14 :6586 [run_manager.py:_upsert_run():1039] saving pip packages
-2019-11-14 00:33:42,032 INFO    Thread-14 :6586 [run_manager.py:_upsert_run():1041] initializing streaming files api
-2019-11-14 00:33:42,032 INFO    Thread-14 :6586 [run_manager.py:_upsert_run():1048] unblocking file change observer, beginning sync with W&B servers
-2019-11-14 00:33:42,032 INFO    MainThread:6586 [run_manager.py:wrap_existing_process():1148] informing user process we are ready to proceed
-2019-11-14 00:33:42,035 DEBUG   Thread-15 :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-14 00:33:42,035 INFO    MainThread:6586 [run_manager.py:_sync_etc():1255] entering loop for messages from user process
-2019-11-14 00:33:42,300 DEBUG   Thread-15 :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 46
-2019-11-14 00:33:42,483 INFO    Thread-3  :6586 [run_manager.py:_on_file_modified():682] file/dir modified: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/config.yaml
-2019-11-14 00:33:42,490 DEBUG   Thread-3  :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-14 00:33:42,830 DEBUG   Thread-3  :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 622
-2019-11-14 00:33:42,832 INFO    Thread-3  :6586 [run_manager.py:_on_file_created():671] file/dir created: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/wandb-metadata.json
-2019-11-14 00:33:42,832 INFO    Thread-3  :6586 [run_manager.py:_on_file_created():671] file/dir created: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/requirements.txt
-2019-11-14 00:33:42,833 INFO    Thread-3  :6586 [run_manager.py:_on_file_created():671] file/dir created: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/diff.patch
-2019-11-14 00:33:42,833 INFO    Thread-3  :6586 [run_manager.py:_on_file_created():671] file/dir created: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/output.log
-2019-11-14 00:33:43,483 INFO    Thread-3  :6586 [run_manager.py:_on_file_created():671] file/dir created: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/wandb-summary.json
-2019-11-14 00:33:44,484 INFO    Thread-3  :6586 [run_manager.py:_on_file_modified():682] file/dir modified: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/wandb-summary.json
-2019-11-14 00:33:44,485 INFO    Thread-3  :6586 [run_manager.py:_on_file_modified():682] file/dir modified: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/output.log
-2019-11-14 00:33:44,487 DEBUG   Thread-7  :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-14 00:33:44,491 DEBUG   Thread-16 :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-14 00:33:44,744 DEBUG   Thread-16 :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 800
-2019-11-14 00:33:44,748 DEBUG   Thread-16 :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): storage.googleapis.com:443
-2019-11-14 00:33:45,165 DEBUG   Thread-7  :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/ilya-trushkin/digit-recognizer/opwf6x0m/file_stream HTTP/1.1" 200 311
-2019-11-14 00:33:45,277 DEBUG   Thread-16 :6586 [connectionpool.py:_make_request():437] https://storage.googleapis.com:443 "PUT /wandb-production.appspot.com/ilya-trushkin/digit-recognizer/opwf6x0m/___batch_archive_1.tgz?Expires=1573680884&GoogleAccessId=gorilla-cloud-storage%40wandb-production.iam.gserviceaccount.com&Signature=SgwTmUypTovpSGaXbjGM2d5KEwDfD%2B88WYVe7gBMpqmLbRVjHpMuVO%2FAH%2BFwfM1tQ2gINFouAGehkyF6AhJu1jr88ToE4P%2BMuG%2FbAETJ03Ukslwh01hE66TelmA2PJX3rMzI4xAq38wxN4LVEn9garzlPJL2spHDjFB1Ao1V5NJu39LbmYKRSuJCZKU%2B6FdGO6hcZIS7f4EC6wAIkeYkRmrZwhADSpp0pI7dCFIXNiDHPy%2Fbvta1fLfdPbzMYmqDUr4mBrpFD2%2BB7ToPoEfeMUFBaC%2B4nwh6aqV3PrQvNnXZicN8Bt0lu6OYOF22DnzExPX3KslxLTyvOHWkyt4KtQ%3D%3D HTTP/1.1" 200 0
-2019-11-14 00:33:45,829 INFO    MainThread:6586 [run_manager.py:_sync_etc():1311] process received interrupt signal, shutting down
-2019-11-14 00:33:45,829 INFO    MainThread:6586 [run_manager.py:_sync_etc():1364] closing log streams and sending exitcode to W&B
-2019-11-14 00:33:45,830 INFO    MainThread:6586 [run_manager.py:shutdown():1055] shutting down system stats and metadata service
-2019-11-14 00:33:46,485 INFO    Thread-3  :6586 [run_manager.py:_on_file_created():671] file/dir created: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/wandb-events.jsonl
-2019-11-14 00:33:46,692 INFO    MainThread:6586 [run_manager.py:shutdown():1067] stopping streaming files and file change observer
-2019-11-14 00:33:46,713 DEBUG   Thread-7  :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/ilya-trushkin/digit-recognizer/opwf6x0m/file_stream HTTP/1.1" 200 311
-2019-11-14 00:33:47,485 INFO    Thread-3  :6586 [run_manager.py:_on_file_modified():682] file/dir modified: /home/itrushkin/Documents/digit-recognizer/wandb/run-20191113_213341-opwf6x0m/wandb-metadata.json
-2019-11-14 00:33:47,495 DEBUG   MainThread:6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-14 00:33:47,803 DEBUG   MainThread:6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 622
-2019-11-14 00:33:49,498 DEBUG   Thread-19 :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-14 00:33:49,777 DEBUG   Thread-19 :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 814
-2019-11-14 00:33:49,782 DEBUG   Thread-19 :6586 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): storage.googleapis.com:443
-2019-11-14 00:33:50,059 DEBUG   Thread-7  :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/ilya-trushkin/digit-recognizer/opwf6x0m/file_stream HTTP/1.1" 200 311
-2019-11-14 00:33:50,246 DEBUG   Thread-7  :6586 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/ilya-trushkin/digit-recognizer/opwf6x0m/file_stream HTTP/1.1" 200 310
-2019-11-14 00:33:50,246 INFO    MainThread:6586 [run_manager.py:_sync_etc():1376] process only ran for 9 seconds, not syncing files
-2019-11-14 00:33:50,246 INFO    MainThread:6586 [opwf6x0m:run_manager.py:_sync_etc():1376] process only ran for 9 seconds, not syncing files
+2019-11-14 01:19:38,813 DEBUG   MainThread:9399 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
+2019-11-14 01:19:38,818 DEBUG   MainThread:9399 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=<valid stream>)
+2019-11-14 01:19:38,822 DEBUG   MainThread:9399 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
+2019-11-14 01:19:38,825 DEBUG   MainThread:9399 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
+2019-11-14 01:19:38,830 DEBUG   MainThread:9399 [run_manager.py:__init__():535] Initialized sync for digit-recognizer/014uwmsd
+2019-11-14 01:19:38,832 INFO    MainThread:9399 [run_manager.py:wrap_existing_process():1131] wrapping existing process 9388
+2019-11-14 01:19:38,832 WARNING MainThread:9399 [io_wrap.py:register():104] SIGWINCH handler was not None: <Handlers.SIG_DFL: 0>
+2019-11-14 01:19:38,835 DEBUG   MainThread:9399 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
+2019-11-14 01:19:38,972 DEBUG   MainThread:9399 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
+2019-11-14 01:19:39,019 INFO    MainThread:9399 [run_manager.py:init_run():916] system metrics and metadata threads started
+2019-11-14 01:19:39,019 INFO    MainThread:9399 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
+2019-11-14 01:19:39,032 DEBUG   Thread-14 :9399 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
+2019-11-14 01:19:39,318 DEBUG   Thread-14 :9399 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 578
+2019-11-14 01:19:39,324 INFO    Thread-14 :9399 [run_manager.py:_upsert_run():1035] saving patches
+2019-11-14 01:19:39,324 DEBUG   Thread-14 :9399 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
+2019-11-14 01:19:39,328 DEBUG   Thread-14 :9399 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
+2019-11-14 01:19:39,332 DEBUG   Thread-14 :9399 [cmd.py:execute():724] Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
+2019-11-14 01:19:39,337 DEBUG   Thread-14 :9399 [cmd.py:execute():724] Popen(['git', 'version'], cwd=/home/itrushkin/Documents/digit-recognizer, universal_newlines=False, shell=None, istream=None)
